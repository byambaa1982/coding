{% extends "base.html" %}

{% block title %}My Dashboard - {{ config.APP_NAME }}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold mb-8">Welcome back, {{ current_user.full_name or current_user.username }}!</h1>
    
    <!-- Quick Actions -->
    <div class="bg-gradient-to-r from-blue-500 to-indigo-600 rounded-lg shadow-lg p-6 mb-8 text-white">
        <div class="flex items-center justify-between">
            <div>
                <h2 class="text-2xl font-bold mb-2">ðŸš€ Practice Your Skills</h2>
                <p class="text-blue-100 mb-4">Test your Python knowledge with interactive coding exercises</p>
                <a href="{{ url_for('python_practice.lesson_exercises', lesson_id=1) }}" 
                   class="inline-block px-6 py-3 bg-white text-indigo-600 font-semibold rounded-lg hover:bg-blue-50 transition shadow-md">
                    <i class="fas fa-code"></i> Start Practicing â†’
                </a>
            </div>
            <div class="hidden md:block">
                <i class="fas fa-laptop-code text-6xl opacity-20"></i>
            </div>
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <!-- Total Courses -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm text-gray-600 mb-1">Total Courses</p>
                    <p class="text-3xl font-bold text-indigo-600">{{ total_enrollments }}</p>
                </div>
                <div class="p-3 bg-indigo-100 rounded-full">
                    <i class="fas fa-book text-2xl text-indigo-600"></i>
                </div>
            </div>
        </div>
        
        <!-- Completed -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm text-gray-600 mb-1">Completed</p>
                    <p class="text-3xl font-bold text-green-600">{{ completed_courses }}</p>
                </div>
                <div class="p-3 bg-green-100 rounded-full">
                    <i class="fas fa-check-circle text-2xl text-green-600"></i>
                </div>
            </div>
        </div>
        
        <!-- Python Courses -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm text-gray-600 mb-1">Python Courses</p>
                    <p class="text-3xl font-bold text-blue-600">{{ python_courses }}</p>
                </div>
                <div class="p-3 bg-blue-100 rounded-full">
                    <i class="fab fa-python text-2xl text-blue-600"></i>
                </div>
            </div>
        </div>
        
        <!-- SQL Courses -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm text-gray-600 mb-1">SQL Courses</p>
                    <p class="text-3xl font-bold text-purple-600">{{ sql_courses }}</p>
                </div>
                <div class="p-3 bg-purple-100 rounded-full">
                    <i class="fas fa-database text-2xl text-purple-600"></i>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Active Courses -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
        <div class="bg-white rounded-lg shadow-md p-6">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-2xl font-bold">Continue Learning</h2>
                <a href="{{ url_for('account.my_courses') }}" class="text-indigo-600 hover:text-indigo-800">
                    View All â†’
                </a>
            </div>
            
            {% if active_enrollments %}
            <div class="space-y-4">
                {% for enrollment in active_enrollments %}
                <div class="border rounded-lg p-4 hover:shadow-md transition">
                    <div class="flex items-start justify-between mb-2">
                        <div class="flex-1">
                            <h3 class="font-semibold mb-1">{{ enrollment.tutorial.title }}</h3>
                            <p class="text-sm text-gray-600">
                                <span class="inline-block px-2 py-1 text-xs rounded 
                                    {% if enrollment.tutorial.course_type == 'python' %}bg-blue-100 text-blue-800
                                    {% else %}bg-green-100 text-green-800{% endif %}">
                                    {{ enrollment.tutorial.course_type|upper }}
                                </span>
                            </p>
                        </div>
                        <a href="{{ url_for('catalog.course_detail', slug=enrollment.tutorial.slug) }}" 
                           class="ml-4 text-indigo-600 hover:text-indigo-800">
                            <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                    
                    <!-- Progress Bar -->
                    <div class="mt-3">
                        <div class="flex items-center justify-between text-sm mb-1">
                            <span class="text-gray-600">Progress</span>
                            <span class="font-semibold">{{ "%.0f"|format(enrollment.progress_percentage) }}%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-indigo-600 h-2 rounded-full" 
                                 style="width: {{ enrollment.progress_percentage }}%"></div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="text-center py-8 text-gray-500">
                <i class="fas fa-book-open text-4xl mb-3"></i>
                <p>No courses in progress</p>
                <a href="{{ url_for('catalog.index') }}" 
                   class="inline-block mt-4 text-indigo-600 hover:text-indigo-800">
                    Browse courses â†’
                </a>
            </div>
            {% endif %}
        </div>
        
        <!-- Recently Completed -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-2xl font-bold">Recent Achievements</h2>
                <a href="{{ url_for('account.progress') }}" class="text-indigo-600 hover:text-indigo-800">
                    View All â†’
                </a>
            </div>
            
            {% if recent_completions %}
            <div class="space-y-4">
                {% for enrollment in recent_completions %}
                <div class="border rounded-lg p-4 bg-green-50 border-green-200">
                    <div class="flex items-start">
                        <div class="p-2 bg-green-100 rounded-full mr-3">
                            <i class="fas fa-trophy text-green-600"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-semibold mb-1">{{ enrollment.tutorial.title }}</h3>
                            <p class="text-sm text-gray-600">
                                Completed on {{ enrollment.completed_at.strftime('%B %d, %Y') }}
                            </p>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="text-center py-8 text-gray-500">
                <i class="fas fa-medal text-4xl mb-3"></i>
                <p>No completed courses yet</p>
                <p class="text-sm mt-2">Keep learning to earn achievements!</p>
            </div>
            {% endif %}
        </div>
    </div>
    
    <!-- Quick Actions -->
    <div class="bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg shadow-md p-8 text-white">
        <h2 class="text-2xl font-bold mb-6">Quick Actions</h2>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <a href="{{ url_for('account.my_courses') }}" 
               class="bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg p-4 text-center transition">
                <i class="fas fa-book-reader text-3xl mb-2"></i>
                <p class="font-semibold">My Courses</p>
            </a>
            
            <a href="{{ url_for('catalog.index') }}" 
               class="bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg p-4 text-center transition">
                <i class="fas fa-search text-3xl mb-2"></i>
                <p class="font-semibold">Browse Courses</p>
            </a>
            
            <a href="{{ url_for('account.wishlist') }}" 
               class="bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg p-4 text-center transition">
                <i class="fas fa-heart text-3xl mb-2"></i>
                <p class="font-semibold">Wishlist</p>
            </a>
            
            <a href="{{ url_for('payment.order_history') }}" 
               class="bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg p-4 text-center transition">
                <i class="fas fa-receipt text-3xl mb-2"></i>
                <p class="font-semibold">Order History</p>
            </a>
        </div>
    </div>
</div>
{% endblock %}
